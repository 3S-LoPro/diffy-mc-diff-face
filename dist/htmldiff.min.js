!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=3)}([function(e,t,n){"use strict";function r(e){return!g.some(function(t){return null!==e&&e.startsWith(t)})&&h.test(e)}function i(e){return e=p.exec(e)[0]+(e.endsWith("/>")?"/>":">")}function s(e,t,n){return["<",t,' class="',n,'">',e,"</",t,">"].join("")}function a(e){return"<"===e}function o(e){return">"===e}function u(e){return"&"===e}function l(e){return";"===e}function c(e){return v.test(e)}function d(e){return r(e)?i(e):e}function f(e){return w.test(e)}Object.defineProperty(t,"__esModule",{value:!0});var h=/^\s*<\/?[^>]+>\s*$/,p=/<[^\s>]+/,v=/^(\s|&nbsp;)+$/,w=/[\w\#@]+/,g=["<img"];t.isTag=r,t.stripTagAttributes=i,t.wrapText=s,t.isStartOfTag=a,t.isEndOfTag=o,t.isStartOfEntity=u,t.isEndOfEntity=l,t.isWhiteSpace=c,t.stripAnyAttributes=d,t.isWord=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(){function e(t,n,i){r(this,e),this.startInOld=t,this.startInNew=n,this.size=i}return i(e,[{key:"endInOld",get:function(){return this.startInOld+this.size}},{key:"endInNew",get:function(){return this.startInNew+this.size}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.blockSize=0,this.repeatingWordsAccuracy=0,this.ignoreWhitespaceDifferences=!1};t.default=i},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4),u=i(o),l=n(1),c=i(l),d=n(5),f=i(d),h=n(6),p=i(h),v=n(2),w=i(v),g=n(7),y=r(g),W=n(0),b=r(W),I=new Map([["</strong>",0],["</em>",0],["</b>",0],["</i>",0],["</big>",0],["</small>",0],["</u>",0],["</sub>",0],["</strike>",0],["</s>",0]]),O=/<((strong)|(b)|(i)|(em)|(big)|(small)|(u)|(sub)|(sup)|(strike)|(s))[\>\s]+/gi,k=function(){function e(t,n){s(this,e),this.content=[],this.newText=n,this.oldText=t,this.specialTagDiffStack=[],this.newWords=[],this.oldWords=[],this.matchGranularity=0,this.blockExpressions=[],this.repeatingWordsAccuracy=1,this.ignoreWhiteSpaceDifferences=!1,this.orphanMatchThreshold=0}return a(e,[{key:"build",value:function(){if(this.oldText===this.newText)return this.newText;this.splitInputsIntoWords(),this.matchGranularity=Math.min(4,this.oldWords.length,this.newWords.length);var e=this.operations(),t=!0,n=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=i.value;this.performOperation(a)}}catch(e){n=!0,r=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw r}}return this.content.join("")}},{key:"addBlockExpression",value:function(e){this.blockExpressions.push(e)}},{key:"splitInputsIntoWords",value:function(){this.oldWords=y.convertHtmlToListOfWords(this.oldText,this.blockExpressions),this.oldText=null,this.newWords=y.convertHtmlToListOfWords(this.newText,this.blockExpressions),this.newText=null}},{key:"performOperation",value:function(e){switch(e.action){case u.default.equal:this.processEqualOperation(e);break;case u.default.delete:this.processDeleteOperation(e,"diffdel");break;case u.default.insert:this.processInsertOperation(e,"diffins");break;case u.default.none:break;case u.default.replace:this.processReplaceOperation(e)}}},{key:"processReplaceOperation",value:function(e){this.processDeleteOperation(e,"diffmod"),this.processInsertOperation(e,"diffmod")}},{key:"processInsertOperation",value:function(e,t){var n=this.newWords.filter(function(t,n){return n>=e.startInNew&&n<e.endInNew});this.insertTag("ins",t,n)}},{key:"processDeleteOperation",value:function(e,t){var n=this.oldWords.filter(function(t,n){return n>=e.startInOld&&n<e.endInOld});this.insertTag("del",t,n)}},{key:"processEqualOperation",value:function(e){var t=this.newWords.filter(function(t,n){return n>=e.startInNew&&n<e.endInNew});this.content.push(t.join(""))}},{key:"insertTag",value:function(e,t,n){for(;;){if(0===n.length)break;var r=this.extractConsecutiveWords(n,function(e){return!b.isTag(e)}),i="",s=!1;if(0!==r.length){var a=b.wrapText(r.join(""),e,t);this.content.push(a)}else{if(O.test(n[0])){if(this.specialTagDiffStack.push(n[0]),i='<ins class="mod">',"del"===e)for(n.shift();n.length>0&&O.test(n[0]);)n.shift()}else if(I.has(n[0])){var o=0===this.specialTagDiffStack.length?null:this.specialTagDiffStack.pop();if(null!==o&&o===n[0].replace(/\//g,"")&&(i="</ins>",s=!0),"del"===e)for(n.shift();n.length>0&&I.has(n[0]);)n.shift()}if(0===n.length&&0===i.length)break;s?this.content.push(i+this.extractConsecutiveWords(n,b.isTag).join("")):this.content.push(this.extractConsecutiveWords(n,b.isTag).join("")+i)}}}},{key:"extractConsecutiveWords",value:function(e,t){for(var n=null,r=0;r<e.length;r++){var i=e[r];if(0===r&&" "===i&&(e[r]="&nbsp;"),!t(i)){n=r;break}}if(null!==n){var s=e.filter(function(e,t){return t>=0&&t<n});return n>0&&e.splice(0,n),s}var a=e.filter(function(t,n){return n>=0&&n<e.length});return e.splice(0,e.length),a}},{key:"operations",value:function(){var e=0,t=0,n=[],r=this.matchingBlocks();r.push(new c.default(this.oldWords.length,this.newWords.length,0));var i=this.removeOrphans(r),s=!0,a=!1,o=void 0;try{for(var l,d=i[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){var f=l.value,h=e===f.startInOld,v=t===f.startInNew,w=void 0;w=h||v?h&&!v?u.default.insert:h?u.default.none:u.default.delete:u.default.replace,w!==u.default.none&&n.push(new p.default(w,e,f.startInOld,t,f.startInNew)),0!==f.length&&n.push(new p.default(u.default.equal,f.startInOld,f.endInOld,f.startInNew,f.endInNew)),e=f.endInOld,t=f.endInNew}}catch(e){a=!0,o=e}finally{try{!s&&d.return&&d.return()}finally{if(a)throw o}}return n}},{key:"removeOrphans",value:regeneratorRuntime.mark(function e(t){var n,r,i,s,a,o,u,l,d,f,h,p,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=null,r=null,i=!0,s=!1,a=void 0,e.prev=5,o=t[Symbol.iterator]();case 7:if(i=(u=o.next()).done){e.next=31;break}if(l=u.value,null!==r){e.next=13;break}return n=new c.default(0,0,0),r=l,e.abrupt("continue",28);case 13:if(!(n.endInOld===r.startInOld&&n.endInNew===r.startInNew||r.endInOld===l.startInOld&&r.endInNew===l.startInNew)){e.next=19;break}return e.next=16,r;case 16:return d=n=r,r=l,e.abrupt("continue",28);case 19:if(f=function(e,t){return e+t.length},h=this.oldWords.slice(n.endInOld,l.startInOld).reduce(f,0),p=this.newWords.slice(n.endInNew,l.startInNew).reduce(f,0),!((v=this.newWords.slice(r.startInNew,r.endInNew).reduce(f,0))>Math.max(h,p)*this.orphanMatchThreshold)){e.next=26;break}return e.next=26,r;case 26:n=r,r=l;case 28:i=!0,e.next=7;break;case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(5),s=!0,a=e.t0;case 37:e.prev=37,e.prev=38,!i&&o.return&&o.return();case 40:if(e.prev=40,!s){e.next=43;break}throw a;case 43:return e.finish(40);case 44:return e.finish(37);case 45:return e.next=47,r;case 47:case"end":return e.stop()}},e,this,[[5,33,37,45],[38,,40,44]])})},{key:"matchingBlocks",value:function(){var e=[];return this.findMatchingBlocks(0,this.oldWords.length,0,this.newWords.length,e),e}},{key:"findMatchingBlocks",value:function(e,t,n,r,i){var s=this.findMatch(e,t,n,r);null!==s&&(e<s.startInOld&&n<s.startInNew&&this.findMatchingBlocks(e,s.startInOld,n,s.startInNew,i),i.push(s),s.endInOld<t&&s.endInNew<r&&this.findMatchingBlocks(s.endInOld,t,s.endInNew,r,i))}},{key:"findMatch",value:function(e,t,n,r){for(var i=this.matchGranularity;i>0;i--){var s=new w.default;s.blockSize=i,s.repeatingWordsAccuracy=this.repeatingWordsAccuracy,s.ignoreWhitespaceDifferences=this.ignoreWhiteSpaceDifferences;var a=new f.default(this.oldWords,this.newWords,e,t,n,r,s),o=a.findMatch();if(null!==o)return o}return null}}]),e}();k.execute=function(e,t){return new k(e,t).build()},t.default=k},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={equal:0,delete:1,insert:2,none:3,replace:4};t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,n){return e.push(t),e.length>n&&e.shift(),e.length!==n?null:e.join("")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),u=r(o),l=n(2),c=(r(l),n(0)),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(c),f=function(){function e(t,n,r,s,a,o,u){i(this,e),this.oldWords=t,this.newWords=n,this.startInOld=r,this.endInOld=s,this.startInNew=a,this.endInNew=o,this.options=u}return a(e,[{key:"indexNewWords",value:function(){this.wordIndices=new Map;for(var e=[],t=this.startInNew;t<this.endInNew;t++){var n=this.normalizeForIndex(this.newWords[t]),r=s(e,n,this.options.blockSize);null!==r&&(this.wordIndices.has(r)?this.wordIndices.get(r).push(t):this.wordIndices.set(r,[t]))}}},{key:"normalizeForIndex",value:function(e){return e=d.stripAnyAttributes(e),this.options.IgnoreWhiteSpaceDifferences&&d.isWhiteSpace(e)?" ":e}},{key:"findMatch",value:function(){if(this.indexNewWords(),this.removeRepeatingWords(),0===this.wordIndices.length)return null;for(var e=this.startInOld,t=this.startInNew,n=0,r=new Map,i=this.options.blockSize,a=[],o=this.startInOld;o<this.endInOld;o++){var l=this.normalizeForIndex(this.oldWords[o]),c=s(a,l,i);if(null!==c){var d=new Map;if(this.wordIndices.has(c)){var f=!0,h=!1,p=void 0;try{for(var v,w=this.wordIndices.get(c)[Symbol.iterator]();!(f=(v=w.next()).done);f=!0){var g=v.value,y=(r.has(g-1)?r.get(g-1):0)+1;d.set(g,y),y>n&&(e=o-y-i+2,t=g-y-i+2,n=y)}}catch(e){h=!0,p=e}finally{try{!f&&w.return&&w.return()}finally{if(h)throw p}}r=d}else r=d}}return 0!==n?new u.default(e,t,n+i-1):null}},{key:"removeRepeatingWords",value:function(){var e=this.newWords.length+this.options.repeatingWordsAccuracy,t=Array.from(this.wordIndices.entries()).filter(function(t){return t[1].length>e}).map(function(e){return e[0]}),n=!0,r=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var o=s.value;this.wordIndices.delete(o)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,n,i,s,a){r(this,e),this.action=t,this.startInOld=n,this.endInOld=i,this.startInNew=s,this.endInNew=a};t.default=i},function(e,t,n){"use strict";function r(e,t){for(var n={mode:o.default.character,currentWord:[],words:[]},r=s(e,t),a=!!r.size,u=!1,c=-1,d=0;d<e.length;d++){var f=e[d];if(a){c===index&&(c=-1,u=!1);var h=0;if(r.has(index)&&(h=r.get(index),u=!0,c=h),u){n.currentWord.push(f),n.mode=o.default.character;continue}}switch(n.mode){case o.default.character:l.isStartOfTag(f)?i(n,"<",o.default.tag):l.isStartOfEntity(f)?i(n,f,o.default.entity):l.isWhiteSpace(f)?i(n,f,o.default.whitespace):l.isWord(f)&&(0===n.currentWord.length||l.isWord(n.currentWord[n.currentWord.length-1]))?n.currentWord.push(f):i(n,f,o.default.character);break;case o.default.tag:l.isEndOfTag(f)?(n.currentWord.push(f),n.words.push(n.currentWord.join("")),n.currentWord=[],n.mode=l.isWhiteSpace(f)?o.default.whitespace:o.default.character):n.currentWord.push(f);break;case o.default.whitespace:l.isStartOfTag(f)?i(n,f,o.default.tag):l.isStartOfEntity(f)?i(n,f,o.default.entity):l.isWhiteSpace(f)?n.currentWord.push(f):i(n,f,o.default.character);break;case o.default.entity:if(l.isStartOfTag(f))i(n,f,o.default.tag);else if(l.isWhiteSpace(f))i(n,f,o.default.whitespace);else if(l.isEndOfEntity(f)){var p=!0;if(0!==n.currentWord.length&&(n.currentWord.push(f),n.words.push(n.currentWord.join("")),n.words.length>2&&l.isWhiteSpace(n.words[n.words.length-2])&&l.isWhiteSpace(n.words[n.words.length-1]))){var v=n.words[n.words.length-2],w=n.words[n.words.length-1];n.words.splice(words.length-2,2),n.currentWord=[(v+w).split()],n.mode=o.default.whitespace,p=!1}p&&(n.currentWord=[],n.mode=o.default.character)}else l.isWord(f)?n.currentWord.push(f):i(n,f,o.default.character)}}return 0!==n.currentWord.length&&n.words.push(n.currentWord.join("")),n.words}function i(e,t,n){0!==e.currentWord.length&&e.words.push(e.currentWord.join("")),e.currentWord=[t],e.mode=n}function s(e,t){var n=new Map;if(null===t)return n;var r=!0,i=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(r=(a=o.next()).done);r=!0)for(var u=a.value,l=void 0;null!==(l=u.exec(e));){if(n.has(l.index))throw new Error("One or more block expressions result in a text sequence that overlaps. Current expression: "+u.toString());n.set(l.index,l.index+l[0].length)}}catch(e){i=!0,s=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw s}}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.convertHtmlToListOfWords=void 0;var a=n(8),o=function(e){return e&&e.__esModule?e:{default:e}}(a),u=n(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u);t.convertHtmlToListOfWords=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={character:0,tag:1,whitespace:2,entity:3};t.default=r}]);